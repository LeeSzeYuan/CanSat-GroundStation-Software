
<!DOCTYPE html>
<html>
    <head><meta http-equiv="Content-Type" content="text/html; charset=utf-8">

        <link rel="stylesheet" type="text/css" href="style.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    </head>
    <header class="header">
        <h1> Battery Level</h1>
    </header>
<body>
    <section class="content">

	    <div class="box gauge--1">
	    <h3>BATTERY LEVEL</h3>
              <div class="mask">
			  <div class="semi-circle"></div>
			  <div class="semi-circle--mask"></div>
			</div>
		    <p style="font-size: 30px;" id="energy">--</p>
        </div>
    </section>
    

<script>
    function loadBattery(){
        xhr = new XMLHttpRequest();
        xhr.open('GET', 'station.php', true);

        xhr.onload = function(){
            if (this.status === 200){
                var info = JSON.parse(this.responseText)
                //console.log(info);

                setEnergy(info[0]);
            }
        }
        xhr.send()

        
    }
    
    


    function setEnergy(curVal = 0){
    	//set range for Temperature in Celsius -5 Celsius to 38 Celsius
    	var minEnergy = 0.0;
    	var maxEnergy = 100.0;
        //set range for Temperature in Fahrenheit 23 Fahrenheit to 100 Fahrenheit
    	//var minTemp = 23;
    	//var maxTemp = 100;

    	var newVal = scaleValue(curVal, [minEnergy, maxEnergy], [0, 180]);
    	$('.gauge--1 .semi-circle--mask').attr({
    		style: '-webkit-transform: rotate(' + newVal + 'deg);' +
    		'-moz-transform: rotate(' + newVal + 'deg);' +
    		'transform: rotate(' + newVal + 'deg);'
    	});
    	$("#energy").text(curVal + ' %');
    }

    function scaleValue(value, from, to) {
        var scale = (to[1] - to[0]) / (from[1] - from[0]);
        var capped = Math.min(from[1], Math.max(from[0], value)) - from[0];
        return ~~(capped * scale + to[0]);
    }

    setInterval(loadBattery, 100)
</script>
</body>
</html>